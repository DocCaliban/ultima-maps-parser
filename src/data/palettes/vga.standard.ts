import { Palette } from "../../graphics/types/palette.types";

/**
 * VGA palette used by *Ultima III* (extracted from `U3VGA.PAL`)
 *
 * Maps pixel indices 0–255 to RGBA values. The palette is structured as:
 * - Indices 0–15: standard base colors (legacy compatibility)
 * - Indices 16–231: 6x6x6 RGB color cube
 * - Indices 232–255: 24 grayscale shades
 *
 * Each entry is an `[r, g, b, a]` tuple with components in the 0–255 range.
 * Alpha is not stored in the original palette and therefore defaults to 255.
 */
export const vga256: Palette = [
  // Standard 16 colors
  [0, 0, 0, 255],
  [0, 0, 130, 255],
  [0, 130, 0, 255],
  [0, 130, 130, 255],
  [130, 0, 0, 255],
  [130, 0, 130, 255],
  [194, 130, 65, 255],
  [194, 194, 194, 255],
  [130, 130, 130, 255],
  [65, 65, 255, 255],
  [0, 194, 0, 255],
  [32, 255, 255, 255],
  [255, 121, 121, 255],
  [255, 32, 255, 255],
  [255, 255, 65, 255],
  [255, 255, 255, 255],
  [16, 16, 16, 255],
  [0, 0, 65, 255],
  [0, 32, 0, 255],
  [0, 32, 32, 255],
  [65, 0, 0, 255],
  [65, 0, 65, 255],
  [97, 32, 0, 255],
  [255, 32, 32, 255],
  [255, 97, 0, 255],
  [97, 97, 255, 255],
  [65, 255, 65, 255],
  [65, 255, 255, 255],
  [210, 146, 113, 255],
  [255, 65, 255, 255],
  [255, 255, 97, 255],
  [235, 235, 235, 255],
  [32, 32, 32, 255],
  [0, 0, 97, 255],
  [0, 65, 0, 255],
  [0, 65, 65, 255],
  [97, 0, 0, 255],
  [97, 0, 97, 255],
  [113, 49, 16, 255],
  [255, 65, 65, 255],
  [255, 130, 0, 255],
  [130, 130, 255, 255],
  [130, 255, 130, 255],
  [130, 255, 255, 255],
  [227, 162, 130, 255],
  [255, 130, 255, 255],
  [255, 255, 130, 255],
  [215, 215, 215, 255],
  [49, 49, 49, 255],
  [0, 0, 130, 255],
  [0, 97, 0, 255],
  [0, 97, 97, 255],
  [130, 0, 0, 255],
  [130, 0, 130, 255],
  [130, 65, 32, 255],
  [255, 97, 97, 255],
  [255, 162, 0, 255],
  [162, 162, 255, 255],
  [162, 255, 162, 255],
  [162, 255, 255, 255],
  [243, 178, 146, 255],
  [255, 162, 255, 255],
  [255, 255, 162, 255],
  [198, 198, 198, 255],
  [65, 65, 65, 255],
  [0, 0, 162, 255],
  [0, 130, 0, 255],
  [0, 130, 130, 255],
  [162, 0, 0, 255],
  [162, 0, 162, 255],
  [146, 81, 49, 255],
  [255, 130, 130, 255],
  [255, 194, 0, 255],
  [194, 194, 255, 255],
  [194, 255, 194, 255],
  [194, 255, 255, 255],
  [255, 194, 162, 255],
  [255, 194, 255, 255],
  [255, 255, 194, 255],
  [178, 178, 178, 255],
  [81, 81, 81, 255],
  [0, 0, 194, 255],
  [0, 162, 0, 255],
  [0, 162, 162, 255],
  [194, 0, 0, 255],
  [194, 0, 194, 255],
  [162, 97, 65, 255],
  [255, 162, 162, 255],
  [255, 227, 0, 255],
  [227, 227, 255, 255],
  [227, 255, 227, 255],
  [227, 255, 255, 255],
  [255, 210, 178, 255],
  [255, 227, 255, 255],
  [255, 255, 227, 255],
  [162, 162, 162, 255],
  [97, 97, 97, 255],
  [0, 0, 227, 255],
  [0, 194, 0, 255],
  [0, 194, 194, 255],
  [227, 0, 0, 255],
  [227, 0, 227, 255],
  [178, 113, 81, 255],
  [255, 194, 194, 255],
  [255, 255, 0, 255],
  [49, 4, 0, 255],
  [186, 150, 138, 255],
  [247, 166, 158, 255],
  [255, 227, 194, 255],
  [146, 125, 97, 255],
  [109, 109, 109, 255],
  [146, 146, 146, 255],
  [113, 113, 113, 255],
  [0, 0, 255, 255],
  [0, 227, 0, 255],
  [0, 227, 227, 255],
  [255, 0, 0, 255],
  [255, 0, 255, 255],
  [194, 130, 97, 255],
  [255, 227, 227, 255],
  [255, 255, 32, 255],
  [73, 8, 0, 255],
  [219, 57, 45, 255],
  [150, 105, 81, 255],
  [255, 243, 210, 255],
  [125, 125, 125, 255],
  [125, 125, 125, 255],
  [130, 130, 130, 255],
  [130, 130, 130, 255],
  [45, 255, 210, 255],
  [113, 105, 85, 255],
  [45, 255, 210, 255],
  [45, 255, 210, 255],
  [45, 255, 210, 255],
  [93, 85, 0, 255],
  [235, 235, 0, 255],
  [255, 89, 0, 255],
  [45, 255, 210, 255],
  [45, 255, 210, 255],
  [251, 162, 130, 255],
  [255, 178, 178, 255],
  [45, 255, 210, 255],
  [45, 255, 210, 255],
  [142, 142, 142, 255],
  [146, 146, 146, 255],
  [4, 4, 4, 255],
  [105, 97, 77, 255],
  [8, 8, 8, 255],
  [12, 12, 12, 255],
  [45, 255, 210, 255],
  [73, 65, 0, 255],
  [215, 206, 0, 255],
  [255, 81, 0, 255],
  [20, 20, 20, 255],
  [24, 24, 24, 255],
  [251, 154, 121, 255],
  [255, 170, 170, 255],
  [28, 28, 28, 255],
  [45, 255, 210, 255],
  [36, 36, 36, 255],
  [40, 40, 40, 255],
  [45, 45, 45, 255],
  [97, 89, 77, 255],
  [45, 255, 210, 255],
  [53, 53, 53, 255],
  [57, 57, 57, 255],
  [53, 45, 0, 255],
  [194, 182, 0, 255],
  [255, 73, 0, 255],
  [61, 61, 61, 255],
  [45, 255, 210, 255],
  [251, 146, 113, 255],
  [255, 162, 162, 255],
  [69, 69, 69, 255],
  [73, 73, 73, 255],
  [53, 28, 12, 255],
  [77, 77, 77, 255],
  [45, 255, 210, 255],
  [97, 89, 69, 255],
  [85, 85, 85, 255],
  [89, 89, 89, 255],
  [93, 93, 93, 255],
  [32, 28, 0, 255],
  [174, 166, 0, 255],
  [255, 65, 0, 255],
  [45, 255, 210, 255],
  [101, 101, 101, 255],
  [251, 138, 105, 255],
  [255, 154, 154, 255],
  [105, 105, 105, 255],
  [109, 109, 109, 255],
  [45, 255, 210, 255],
  [117, 117, 117, 255],
  [121, 121, 121, 255],
  [89, 81, 61, 255],
  [125, 125, 125, 255],
  [45, 255, 210, 255],
  [134, 134, 134, 255],
  [138, 138, 138, 255],
  [154, 142, 0, 255],
  [255, 49, 0, 255],
  [142, 142, 142, 255],
  [45, 255, 210, 255],
  [251, 130, 97, 255],
  [255, 146, 146, 255],
  [150, 150, 150, 255],
  [154, 154, 154, 255],
  [158, 158, 158, 255],
  [45, 255, 210, 255],
  [166, 166, 166, 255],
  [89, 73, 61, 255],
  [170, 170, 170, 255],
  [174, 174, 174, 255],
  [45, 255, 210, 255],
  [182, 182, 182, 255],
  [134, 121, 0, 255],
  [255, 32, 0, 255],
  [186, 186, 186, 255],
  [190, 190, 190, 255],
  [251, 121, 89, 255],
  [255, 138, 138, 255],
  [194, 194, 194, 255],
  [202, 202, 202, 255],
  [206, 206, 206, 255],
  [210, 210, 210, 255],
  [45, 255, 210, 255],
  [81, 65, 57, 255],
  [219, 219, 219, 255],
  [223, 223, 223, 255],
  [227, 227, 227, 255],
  [231, 231, 231, 255],
  [113, 105, 0, 255],
  [255, 16, 0, 255],
  [45, 255, 210, 255],
  [239, 239, 239, 255],
  [251, 113, 81, 255],
  [255, 130, 130, 255],
  [243, 243, 243, 255],
  [247, 247, 247, 255],
  [251, 251, 251, 255],
  [255, 255, 210, 255],
  [0, 0, 130, 255],
  [0, 130, 0, 255],
  [0, 130, 130, 255],
  [130, 0, 0, 255],
  [130, 0, 130, 255],
  [194, 130, 65, 255],
  [255, 57, 0, 255],
  [255, 239, 170, 255],
  [65, 65, 255, 255],
  [0, 194, 0, 255],
  [65, 255, 255, 255],
  [255, 130, 130, 255],
  [255, 130, 255, 255],
  [255, 255, 130, 255],
  [85, 61, 45, 255],
];

// // Default generated VGA 256 palette (6x6x6 cube + grays), scaled to 0-255
// const defaultVga256 = (): Palette => {
//   const palette: RGBAPixel[] = [];
//   // Standard 16 colors
//   palette.push(
//     [0, 0, 0, 255],
//     [0, 0, 170, 255],
//     [0, 170, 0, 255],
//     [0, 170, 170, 255],
//     [170, 0, 0, 255],
//     [170, 0, 170, 255],
//     [170, 85, 0, 255],
//     [170, 170, 170, 255],
//     [85, 85, 85, 255],
//     [85, 85, 255, 255],
//     [85, 255, 85, 255],
//     [85, 255, 255, 255],
//     [255, 85, 85, 255],
//     [255, 85, 255, 255],
//     [255, 255, 85, 255],
//     [255, 255, 255, 255]
//   );

//   // 6x6x6 RGB cube (values mapped from 6-step to 0-255)
//   const steps = [0, 51, 102, 153, 204, 255];
//   for (const r of steps) {
//     for (const g of steps) {
//       for (const b of steps) {
//         palette.push([r, g, b, 255]);
//       }
//     }
//   }

//   // 24 grayscale shades
//   for (let i = 0; i < 24; i++) {
//     const v = 8 + i * 10;
//     palette.push([v, v, v, 255]);
//   }

//   return palette;
// };

// // Try to load `data/ultima-3/U3VGA.PAL` (256 entries, 3 bytes each, 0-63 range)
// const tryLoadU3VgaPal = (): Palette | null => {
//   try {
//     const palPath = path.resolve(__dirname, '../../../data/ultima-3/U3VGA.PAL');
//     if (!fs.existsSync(palPath)) return null;
//     const buf = fs.readFileSync(palPath);
//     if (buf.length < 768) return null;

//     const pal: Palette = [];
//     for (let i = 0; i < 256; i++) {
//       const r6 = buf.readUInt8(i * 3);
//       const g6 = buf.readUInt8(i * 3 + 1);
//       const b6 = buf.readUInt8(i * 3 + 2);
//       // Scale 6-bit (0-63) to 0-255
//       const r = Math.round((r6 * 255) / 63);
//       const g = Math.round((g6 * 255) / 63);
//       const b = Math.round((b6 * 255) / 63);
//       pal.push([r, g, b, 255]);
//     }

//     console.log(JSON.stringify(pal));

//     return pal;
//   } catch (e) {
//     return null;
//   }
// };

// const loaded = tryLoadU3VgaPal();
// export const vga256: Palette = loaded ?? defaultVga256();
